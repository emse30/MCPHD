//IRMA;ENVHEALTH!HHECMSC!ASP!~
var assignedTo = getAssignedToRecord();
var theDate = hhcgetInspRecheckDate(capId,inspId);
if(checkInspectionResult('Initial Inspection','Complete') && theDate == null) {
	scheduleInspectDate('Follow-up',nextWorkDay(dateAdd(null,0)),assignedTo);  //When there is no Recheck Date
	updateTask('Case Intake','Follow-up','Updated by Script');
}
if(checkInspectionResult('Initial Inspection','Complete') && theDate != null) {
	scheduleInspectDate('Follow-up',theDate,assignedTo);  //When there is a Recheck Date
	updateTask('Case Intake','Follow-up','Updated by Script');
}
if(checkInspectionResult('Initial Inspection','Unable to Inspect')) {
	scheduleInspectDate('Initial Inspection',nextWorkDay(dateAdd(null,0)),assignedTo); 
	}
if(checkInspectionResult('Initial Inspection','Reinspection Needed') && theDate == null) {
	scheduleInspectDate('Follow-up',nextWorkDay(dateAdd(null,0)),assignedTo);  //When there is no Recheck Date
	updateTask('Case Intake','Follow-up','Updated by Script');
}
if(checkInspectionResult('Initial Inspection','Reinspection Needed') && theDate != null) {
	scheduleInspectDate('Follow-up',theDate,assignedTo);  //When there is a Recheck Date
	updateTask('Case Intake','Follow-up','Updated by Script');
}	
if(checkInspectionResult('Follow-up','Complete')) {
	updateTask('Inspection','Complete','Updated by Script');
	}
if(checkInspectionResult('Follow-up','Reinspection Needed')) {
	updateTask('Inspection','Reinspections','Updated by Script');
	scheduleInspectDate('Reinspection',nextWorkDay(dateAdd(null,13)),assignedTo);
	}
if(checkInspectionResult('Reinspection','Reinspection Needed')) {
	scheduleInspectDate('Reinspection',nextWorkDay(dateAdd(null,13)),assignedTo);
	}
if (isTaskStatus('Close','Case Closed')) {
	inspCancelAll();
}
